<!DOCTYPE html>

<html lang="en">

<head>
  <meta charset="utf-8">
  <script src="../js/jquery.js"></script>
  <link rel="stylesheet" href="../css/style.css">
  <title>Flight Planner</title>
</head>


<body id="page">
	<div id="header">
	  <div id="headerimg">
	  </div>
	</div>
	
	<script src="../js/jquery.js"></script>
	<script src="GetResults.js"></script>
	<script src="ThisResult.js"></script>

	<button id="theme_switcher">Dark theme</button>
	<h2><a>History</a></h2>
	<br><br>
  <input type="button" value="Generate Table" onclick="GenerateTable()" />
  <hr />
  <div id="dvTable"></div>
	
	<br><br><br>
	<h2><a>Flight Results</a></h2>
	<br><br>
    <table id="flight"> 
        <tr>
            <th>ID</th>
            <th>NDVI</th>
            <th>Latitude</th>
            <th>Longitude</th>
            <th>Image</th>
        </tr>
        <tbody id="FlightResults"></tbody>
	</table>
	<br><br>
		<button class="square_btn_small" onclick="window.location='History.html'" target="_new">Clear</button>
		<script>
		$(document).ready(function () {
        var theme = 'DEFAULT'
        $('#theme_switcher').on('click', themeSwitcher);
        function themeSwitcher() {
            var isDefaultTheme = theme === 'DEFAULT';
            if(isDefaultTheme){
            theme = 'HIGH_CONTRAST';

            $('body').addClass('HIGH_CONTRAST');
            $('#header').css('background-image', 'none');
            $('#theme_switcher').text('Light theme')
            return;
            }
            if(!isDefaultTheme){
            theme = 'DEFAULT';

            $('body').removeClass('HIGH_CONTRAST');
            $('#header').css('background-image', 'url("../images/FundationHemavLogo.png")');
            $('#theme_switcher').text('Dark theme')

            return;
            }
        }
    })
    </script>
    
    <script type="text/javascript">
      function GenerateTableFlight() {
        clearTimeout;
        const xhttp = new XMLHttpRequest();
        xhttp.open('GET', '/results.json', true);
        xhttp.send();
        xhttp.responseType = "text";
        xhttp.onreadystatechange = function () {
          if (this.readyState == 4 && this.status == 200) {
            let data = JSON.parse(this.responseText);
            var flights = new Array();
            flights.push(["Hour", "View Result"]);
            for (let item of data.flights) {
              flights.push([item.id, "<button class=square_btn_small id=" + item.id + " onclick='OpenFR(this.id)>GO</button>"]);
            }
  
            //Create a HTML Table element.
            var table = document.createElement("TABLE");
            table.border = "1";
  
            //Get the count of columns.
            var columnCount = flights[0].length;
  
            //Add the data rows.
            for (var i = 1; i < flights.length; i++) {
              row = table.insertRow(-1);
              for (var j = 0; j < columnCount; j++) {
                var cell = row.insertCell(-1);
                cell.innerHTML = flights[i][j];
              }
            }
  
            var dvTable = document.getElementById("dvTable");
            dvTable.innerHTML = "";
            dvTable.appendChild(table);
  
          } else {
            console.log('error, readyState is:', this.readyState, 'status fetch is:', this.status)
          }
        }
      }


    </script>
</body>
</html>
