<!DOCTYPE html>

<html lang="en">

<head>
  <meta charset="utf-8">
  <script src="../js/jquery.js"></script>
  <link rel="stylesheet" href="../css/style.css">
  <title>Fight Planner</title>
</head>

<body id="planner">

  <h1>Flight Planner</h1>

  <br><br>
  <button id="connectbut">Connect</button>
  <img id="photoconnection" src="" height="50" width=50>

  <br><br><br>
  <div class="tab">
    <button class="tablinks" onclick="openTab(event, 'flypathtab')">Fly path</button>
    <button class="tablinks" onclick="openTab(event, 'parameterstab')">Other parameters</button>
  </div>
  <div id="flypathtab" class="tabcontent">
    <p>
      Rectangle width: <input id="rectwidthtext" type="number" value="500"> meters
      <br><br>
      Distance: <input id="distancetext" type="number" value=""> meters
      <br>
      Maximum distance: <label id="maxdistancetext" type="number"></label> meters
      <br>
      <button disabled id="uploadbut">Load</button>
      <img id="photoupload" src="" height="50" width=50>
    </p>
  </div>
  <div id="parameterstab" class="tabcontent" style="display:none" >
    <p>
      x = <input id="xtext" type="number" value="500"> meters
      <br>
      L = <input id="Ltext" type="number" value="120"> meters
      <br>
      h = <input id="htext" type="number" value="120"> meters
      <br>
      <button id="savebutton">Save parameters</button>
    </p>
  </div>

  <br><br><br>
  <button disabled id="startbut">START </button>
  <img id="photostart" src="" height="50" width=50>

  <br><br><br>
  <button id="getresultsbut">Get results</button>

  <script>
    openTab(event,'flypathtab');

    function openTab(evt, id)
    {
      var i, tabcontent, tablinks;
      tabcontent = document.getElementsByClassName("tabcontent");
      for (i = 0; i < tabcontent.length; i++) 
      {
        tabcontent[i].style.display = "none";
      }
      tablinks = document.getElementsByClassName("tablinks");
      for (i = 0; i < tablinks.length; i++) 
      {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
      }
      document.getElementById(id).style.display = "block";
    }

    function computeMaxDistance(x,L,d)
    {
      n=0;
      conntinueloop=0;
      while(continueloop==0)
      {
        var computing=60000-x-((L+d)*n);
        if(computing)
      }

      document.getElementById("maxdistancetext").innerHTML='12345';
    }

      $(document).ready(function () 
      {

        $("#connectbut").click(function ()        // click CONNECT
        {
          document.getElementById('photoconnection').src = "./waiting.jpeg";
          $.ajax({
            type: 'GET',
            url: 'http://192.168.1.85:9000/api/connect',
            dataType: 'json',
            success: function(data,textStatus, xhr){
              document.getElementById('photoconnection').src = "./tick.jpg";
              document.getElementById("uploadbut").disabled = false;
            },
            error: function(data,textStatus,xhr){
              document.getElementById('photoconnection').src = "./cross.jpg";
            },
          })
        });

        $("#uploadbut").click(function ()         // click LOAD
        {
          document.getElementById('photoupload').src = "waiting.jpeg";
          document.getElementById("maxdistancetext").readonly=true; //con esto hacemos que el textbox de max distance sea solo leible, no editable
          var x = document.getElementById("distancetext").value;

          if (x != "") 
          {
            xnum = parseFloat(x);
            if (xnum > 10000) // INVENT !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
            {
              alert("Maximum distance: 10000 m")
            }
            else 
            {
              $.ajax
              ({
                type:'POST',
                url: 'http://192.168.0.10:9000/api/load/:distance',
                data: xnum,
                dataType: 'json',
                success: function(data,textStatus, xhr)
                {
                  document.getElementById('photoupload').src = "tick.jpg";
                  document.getElementById("startbut").disabled = false;
                },
                error: function(data,textStatus,xhr)
                {
                  document.getElementById('photoupload').src = "cross.jpg";
                },
              })
            }
          }
        });

        $("#startbut").click(function ()          // click START
        {
          document.getElementById('photoupload').src = "waiting.jpeg";
          $.ajax
          ({
            type: 'GET',
            url: 'http://192.168.0.10:9000/api/start',
            dataType: 'json',
            success: function(data,textStatus, xhr)
            {
              document.getElementById('photostart').src = "tick.jpg";
            },
            error: function(data,textStatus,xhr)
            {
              document.getElementById('photostart').src = "cross.jpg";
            },
          })
        });

        $("#getresultsbut").click(function()      // click GET RESULTS
        {
          window.open("../results/History.html"); 
        })

    });
  </script>

</body>

</html>
