<!DOCTYPE html>

<html lang="en">

<head>
  <meta charset="utf-8">
  <script src="/jquery.js"></script>
  <link rel="stylesheet" href="style.css">
  <title>Fight Planner</title>
</head>

<body id="planner">

  <h1>Flight Planner</h1>

  <button id="connectbut" >Connect</button>
  <img id="photoconnection" src="" height="50" width=50>

  <br>
  Distance (meters): <input id="distancetext" type="number" value="">
  <button disabled id="uploadbut">Load</button>
  <img id="photoupload" src="" height="50" width=50><br> 
  Maximum distance: 10000 m   

  <br>
  <button disabled id="startbut">START </button>
  <img id="photostart" src="" height="50" width=50>

  <br>
  <button id="getresultsbut">Get results</button>

  <script>
    console.log("HEY  I'm the flight planner")

      $(document).ready(function () 
      {

        $("#connectbut").click(function ()        // click CONNECT
        {
          document.getElementById('photoconnection').src = "./waiting.jpeg";
          $.ajax({
            type: 'GET',
            url: 'http://192.168.0.10:9000/api/connect',
            //url: 'http://localhost:9000/api/start/error', // prueba
            dataType: 'json',
            success: function(data,textStatus, xhr){
              document.getElementById('photoconnection').src = "./tick.jpg";
              document.getElementById("uploadbut").disabled = false;
            },
            error: function(data,textStatus,xhr){
              document.getElementById('photoconnection').src = "./cross.jpg";
            },
          })
        });

        $("#uploadbut").click(function ()         // click LOAD
        {
          document.getElementById('photoupload').src = "waiting.jpeg";
          var x = document.getElementById("distancetext").value;
          if (x != "") 
          {
            xnum = parseFloat(x);
            if (xnum > 10000) // INVENT !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
            {
              alert("Maximum distance: 10000 m")
            }
            else 
            {
              $.ajax
              ({
                type:'POST',
                url: 'http://192.168.0.10:9000/api/load/:distance',
                data: xnum,
                dataType: 'json',
                success: function(data,textStatus, xhr)
                {
                  document.getElementById('photoupload').src = "tick.jpg";
                  document.getElementById("startbut").disabled = false;
                },
                error: function(data,textStatus,xhr)
                {
                  document.getElementById('photoupload').src = "cross.jpg";
                },
              })
            }
          }
        });

        $("#startbut").click(function ()          // click START
        {
          document.getElementById('photoupload').src = "waiting.jpeg";
          $.ajax
          ({
            type: 'GET',
            url: 'http://192.168.0.10:9000/api/start',
            dataType: 'json',
            success: function(data,textStatus, xhr)
            {
              document.getElementById('photostart').src = "tick.jpg";
            },
            error: function(data,textStatus,xhr)
            {
              document.getElementById('photostart').src = "cross.jpg";
            },
          })
        });

        $("#getresultsbut").click(function()      // click GET RESULTS
        {
          window.open("./history"); 
        })

    });
  </script>

</body>

</html>
